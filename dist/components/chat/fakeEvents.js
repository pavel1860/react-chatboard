// @ts-nocheck
import { useState, useRef, useCallback } from "react";
import { convertKeysToCamelCase } from "../../model/services/model-context";
// export const mockEvents = [
//   {"type": "span_start", "name": "shiping_reasoning", "attrs": null, "depth": 0, "payload": null, "index": 0, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "4e593520-1806-4ff1-8203-e03d5a62a45b", "path": [0], "created_at": "2025-08-25T08:44:32.392708"},
//   {"type": "span_value", "name": "shiping_reasoning", "attrs": null, "depth": 0, "payload": {"root": {"sep_list": [], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": []}, "children": [{"sep_list": [" ", " "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "you are a helpful customer support assistant for a shipping company named 'ShipingToGo", "index": 1, "_type": "BlockChunk"}, {"content": "you need to help customers with their shipping needs and enquiries", "index": 1, "_type": "BlockChunk"}]}, {"root": {"sep_list": [" "], "has_eol": false, "index": 2, "_type": "BlockSent", "blocks": [{"content": "Task", "index": 1, "_type": "BlockChunk"}]}, "children": [{"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "you main task is to help the user with their shipping needs and enquiries", "index": 1, "_type": "BlockChunk"}]}], "tags": ["tast"], "styles": [], "attrs": {}, "index": 2, "_type": "Block", "role": null, "id": null}, {"root": {"sep_list": [" "], "has_eol": false, "index": 3, "_type": "BlockSent", "blocks": [{"content": "Rules", "index": 1, "_type": "BlockChunk"}]}, "children": [{"sep_list": [" ", " ", " "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "you must be respectful and professional", "index": 1, "_type": "BlockChunk"}, {"content": "you should first understand from the user's question what they are asking for", "index": 1, "_type": "BlockChunk"}, {"content": "you need to gather all the information you need to answer the user's question", "index": 1, "_type": "BlockChunk"}]}], "tags": ["rules"], "styles": [], "attrs": {}, "index": 3, "_type": "Block", "role": null, "id": null}, {"root": {"sep_list": [], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": []}, "children": [{"root": {"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "output", "index": 1, "_type": "BlockChunk"}]}, "children": [{"root": {"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "thought", "index": 1, "_type": "BlockChunk"}]}, "children": [{"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "your thought process goes here", "index": 1, "_type": "BlockChunk"}]}], "tags": [], "styles": ["xml"], "attrs": {}, "index": 1, "_type": "Block", "role": null, "id": null}, {"root": {"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "answer", "index": 1, "_type": "BlockChunk"}]}, "children": [{"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "the answer to the user's question goes here", "index": 1, "_type": "BlockChunk"}]}], "tags": [], "styles": ["xml"], "attrs": {}, "index": 2, "_type": "Block", "role": null, "id": null}], "tags": [], "styles": ["xml"], "attrs": {}, "index": 1, "_type": "Block", "role": null, "id": null}], "tags": ["response_schema"], "styles": [], "attrs": {}, "index": 4, "_type": "Block", "role": null, "id": null}], "role": "system", "tags": [], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "id": null}, "index": 1, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "4e593520-1806-4ff1-8203-e03d5a62a45b", "path": [1], "created_at": "2025-08-25T08:44:32.447020"},
//   {"type": "span_value", "name": "shiping_reasoning", "attrs": null, "depth": 0, "payload": {"root": {"sep_list": [], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": []}, "children": [{"root": {"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "who are you?", "index": 1, "_type": "BlockChunk"}]}, "children": [], "role": "user", "tags": [], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "id": null}], "role": "user", "tags": [], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "id": null}, "index": 2, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "4e593520-1806-4ff1-8203-e03d5a62a45b", "path": [2], "created_at": "2025-08-25T08:44:32.479993"},
//   {"type": "stream_start", "name": "openai_llm", "attrs": null, "depth": 0, "payload": null, "index": 3, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:32.598315"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"root": {"sep_list": ["", "", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": "", "logprob": 0, "index": 1, "_type": "BlockChunk"}, {"content": "<", "logprob": -0.0012386832386255264, "index": 1, "_type": "BlockChunk"}, {"content": "output", "logprob": -2.2842308680992573e-05, "index": 1, "_type": "BlockChunk"}, {"content": ">", "logprob": -0.01818506233394146, "index": 1, "_type": "BlockChunk"}]}, "children": [{"root": {"sep_list": [], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": []}, "children": [], "tags": ["thought"], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "role": null, "id": null}, {"root": {"sep_list": [], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": []}, "children": [], "tags": ["answer"], "styles": [], "attrs": {}, "index": 2, "_type": "Block", "role": null, "id": null}], "tags": ["output", "tag_start"], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "role": null, "id": null}, "index": 4, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.258901"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " ", "logprob": -0.10591595619916916, "index": 3, "_type": "BlockChunk"}, "index": 5, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.261923"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"root": {"sep_list": ["", "", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": " ", "logprob": -0.10591595619916916, "index": 3, "_type": "BlockChunk"}, {"content": " <", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": "thought", "logprob": -3.47626737493556e-05, "index": 1, "_type": "BlockChunk"}, {"content": ">", "logprob": -4.024604277219623e-05, "index": 1, "_type": "BlockChunk"}]}, "children": [], "tags": ["thought", "tag_start"], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "role": null, "id": null}, "index": 6, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.283831"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": "   ", "logprob": -0.16616612672805786, "index": 1, "_type": "BlockChunk"}, "index": 7, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.285655"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " The", "logprob": -0.0011248565278947353, "index": 1, "_type": "BlockChunk"}, "index": 8, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.296628"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " user", "logprob": -0.0019000787287950516, "index": 1, "_type": "BlockChunk"}, "index": 9, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.298716"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " is", "logprob": -0.06291279196739197, "index": 1, "_type": "BlockChunk"}, "index": 10, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.334030"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " asking", "logprob": -0.10593139380216599, "index": 1, "_type": "BlockChunk"}, "index": 11, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.335403"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " about", "logprob": -0.8573232293128967, "index": 1, "_type": "BlockChunk"}, "index": 12, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.356244"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " my", "logprob": -0.028426658362150192, "index": 1, "_type": "BlockChunk"}, "index": 13, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.357856"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " identity", "logprob": -0.018328918144106865, "index": 1, "_type": "BlockChunk"}, "index": 14, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.373649"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " and", "logprob": -0.6680499315261841, "index": 1, "_type": "BlockChunk"}, "index": 15, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.375106"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " role", "logprob": -0.14453263580799103, "index": 1, "_type": "BlockChunk"}, "index": 16, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.410493"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": ",", "logprob": -2.4636576175689697, "index": 1, "_type": "BlockChunk"}, "index": 17, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.426232"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " so", "logprob": -0.8929778933525085, "index": 1, "_type": "BlockChunk"}, "index": 18, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.457665"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " I", "logprob": -0.022074365988373756, "index": 1, "_type": "BlockChunk"}, "index": 19, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.478944"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " need", "logprob": -0.4446248412132263, "index": 1, "_type": "BlockChunk"}, "index": 20, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.504601"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " to", "logprob": -3.173704271830502e-06, "index": 1, "_type": "BlockChunk"}, "index": 21, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.522739"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " clarify", "logprob": -0.960564911365509, "index": 1, "_type": "BlockChunk"}, "index": 22, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.548737"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " who", "logprob": -1.6055090427398682, "index": 1, "_type": "BlockChunk"}, "index": 23, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.566801"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " I", "logprob": -0.00025156480842269957, "index": 1, "_type": "BlockChunk"}, "index": 24, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.584252"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " am", "logprob": -0.0013333364622667432, "index": 1, "_type": "BlockChunk"}, "index": 25, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.586365"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " and", "logprob": -0.037862446159124374, "index": 1, "_type": "BlockChunk"}, "index": 26, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.589295"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " how", "logprob": -2.3482751846313477, "index": 1, "_type": "BlockChunk"}, "index": 27, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.591017"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " I", "logprob": -0.0003076950670219958, "index": 1, "_type": "BlockChunk"}, "index": 28, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.593293"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " can", "logprob": -0.005449801217764616, "index": 1, "_type": "BlockChunk"}, "index": 29, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.595253"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " assist", "logprob": -0.017539504915475845, "index": 1, "_type": "BlockChunk"}, "index": 30, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.598331"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " them", "logprob": -0.030168581753969193, "index": 1, "_type": "BlockChunk"}, "index": 31, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.600474"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": ".", "logprob": -0.06032119691371918, "index": 1, "_type": "BlockChunk"}, "index": 32, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.603944"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " ", "logprob": -4.0484450437361374e-05, "index": 2, "_type": "BlockChunk"}, "index": 33, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.605766"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"default_sep": "", "index": 1, "_type": "BlockList", "blocks": [{"sep_list": ["", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": " </", "logprob": -5.512236498361744e-07, "index": 1, "_type": "BlockChunk"}, {"content": "thought", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": ">", "logprob": -0.00016086915275081992, "index": 1, "_type": "BlockChunk"}]}]}, "index": 34, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.611850"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " ", "logprob": -2.236549335066229e-05, "index": 3, "_type": "BlockChunk"}, "index": 35, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.614659"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"root": {"sep_list": ["", "", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": " ", "logprob": -2.236549335066229e-05, "index": 3, "_type": "BlockChunk"}, {"content": " <", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": "answer", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": ">", "logprob": -1.1041145626222715e-05, "index": 1, "_type": "BlockChunk"}]}, "children": [], "tags": ["answer", "tag_start"], "styles": [], "attrs": {}, "index": 2, "_type": "Block", "role": null, "id": null}, "index": 36, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.619516"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": "   ", "logprob": -0.00297354138456285, "index": 1, "_type": "BlockChunk"}, "index": 37, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.621110"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " I", "logprob": -0.40466755628585815, "index": 1, "_type": "BlockChunk"}, "index": 38, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.622750"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " am", "logprob": -0.0004309076175559312, "index": 1, "_type": "BlockChunk"}, "index": 39, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.624785"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " a", "logprob": -0.008651918731629848, "index": 1, "_type": "BlockChunk"}, "index": 40, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.628030"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " customer", "logprob": -0.5145837068557739, "index": 1, "_type": "BlockChunk"}, "index": 41, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.642385"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " support", "logprob": -3.531315314830863e-06, "index": 1, "_type": "BlockChunk"}, "index": 42, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.654459"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " assistant", "logprob": -6.749814019713085e-06, "index": 1, "_type": "BlockChunk"}, "index": 43, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.663806"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " for", "logprob": -0.0038478169590234756, "index": 1, "_type": "BlockChunk"}, "index": 44, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.667441"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " Shipping", "logprob": -0.5512996315956116, "index": 1, "_type": "BlockChunk"}, "index": 45, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.669779"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": "To", "logprob": -0.00025204161647707224, "index": 1, "_type": "BlockChunk"}, "index": 46, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.672563"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": "Go", "logprob": -1.664371848164592e-05, "index": 1, "_type": "BlockChunk"}, "index": 47, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.674806"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": ".", "logprob": -0.9744064211845398, "index": 1, "_type": "BlockChunk"}, "index": 48, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.676914"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " I'm", "logprob": -0.1787855327129364, "index": 1, "_type": "BlockChunk"}, "index": 49, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.678756"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " here", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, "index": 50, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.681482"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " to", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, "index": 51, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.683311"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " help", "logprob": -0.06998012214899063, "index": 1, "_type": "BlockChunk"}, "index": 52, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.685538"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " you", "logprob": -0.007894543930888176, "index": 1, "_type": "BlockChunk"}, "index": 53, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.687310"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " with", "logprob": -1.0280383548888494e-06, "index": 1, "_type": "BlockChunk"}, "index": 54, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.712442"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " any", "logprob": -0.2818658947944641, "index": 1, "_type": "BlockChunk"}, "index": 55, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.713445"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " shipping", "logprob": -0.2560439705848694, "index": 1, "_type": "BlockChunk"}, "index": 56, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.740093"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " needs", "logprob": -0.14240358769893646, "index": 1, "_type": "BlockChunk"}, "index": 57, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.741473"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " or", "logprob": -0.5246978402137756, "index": 1, "_type": "BlockChunk"}, "index": 58, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.745768"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " inquiries", "logprob": -0.1975722312927246, "index": 1, "_type": "BlockChunk"}, "index": 59, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.747189"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " you", "logprob": -0.0007337473216466606, "index": 1, "_type": "BlockChunk"}, "index": 60, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.771582"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " might", "logprob": -1.2579807043075562, "index": 1, "_type": "BlockChunk"}, "index": 61, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.773830"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " have", "logprob": -3.128163257315464e-07, "index": 1, "_type": "BlockChunk"}, "index": 62, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.790538"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": ".", "logprob": -0.0798281878232956, "index": 1, "_type": "BlockChunk"}, "index": 63, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.792060"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " How", "logprob": -0.07879845798015594, "index": 1, "_type": "BlockChunk"}, "index": 64, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.802102"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " can", "logprob": -0.05488329753279686, "index": 1, "_type": "BlockChunk"}, "index": 65, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.803931"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " I", "logprob": -1.9361264946837764e-07, "index": 1, "_type": "BlockChunk"}, "index": 66, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.820111"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " assist", "logprob": -0.00016551809676457196, "index": 1, "_type": "BlockChunk"}, "index": 67, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.821395"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " you", "logprob": -3.128163257315464e-07, "index": 1, "_type": "BlockChunk"}, "index": 68, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.826059"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " today", "logprob": -0.00023405285901390016, "index": 1, "_type": "BlockChunk"}, "index": 69, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.827321"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": "?", "logprob": -0.0015530710807070136, "index": 1, "_type": "BlockChunk"}, "index": 70, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.829796"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " ", "logprob": -7.703443770878948e-06, "index": 2, "_type": "BlockChunk"}, "index": 71, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.831133"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"default_sep": "", "index": 1, "_type": "BlockList", "blocks": [{"sep_list": ["", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": " </", "logprob": -1.9361264946837764e-07, "index": 1, "_type": "BlockChunk"}, {"content": "answer", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": ">", "logprob": -1.4259644558478612e-05, "index": 1, "_type": "BlockChunk"}]}]}, "index": 72, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.852097"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"default_sep": "", "index": 1, "_type": "BlockList", "blocks": [{"sep_list": ["", "", ""], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "</", "logprob": -1.700132997939363e-05, "index": 1, "_type": "BlockChunk"}, {"content": "output", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": ">", "logprob": -0.0019313741941004992, "index": 1, "_type": "BlockChunk"}]}]}, "index": 73, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.876143"},
//   {"type": "stream_end", "name": "openai_llm", "attrs": null, "depth": 0, "payload": null, "index": 74, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "7a3016fa-77c1-4f22-abff-9ad2c1e1b3dd", "path": [2, 0], "created_at": "2025-08-25T08:44:34.899772"},
//   {"type": "span_value", "name": "shiping_reasoning", "attrs": null, "depth": 0, "payload": {"root": {"sep_list": [], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": []}, "children": [{"root": {"sep_list": ["", "", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": "", "logprob": 0, "index": 1, "_type": "BlockChunk"}, {"content": "<", "logprob": -0.0012386832386255264, "index": 1, "_type": "BlockChunk"}, {"content": "output", "logprob": -2.2842308680992573e-05, "index": 1, "_type": "BlockChunk"}, {"content": ">", "logprob": -0.01818506233394146, "index": 1, "_type": "BlockChunk"}]}, "children": [{"root": {"sep_list": ["", "", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": " ", "logprob": -0.10591595619916916, "index": 3, "_type": "BlockChunk"}, {"content": " <", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": "thought", "logprob": -3.47626737493556e-05, "index": 1, "_type": "BlockChunk"}, {"content": ">", "logprob": -4.024604277219623e-05, "index": 1, "_type": "BlockChunk"}]}, "children": [{"sep_list": ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": "   ", "logprob": -0.16616612672805786, "index": 1, "_type": "BlockChunk"}, {"content": " The", "logprob": -0.0011248565278947353, "index": 1, "_type": "BlockChunk"}, {"content": " user", "logprob": -0.0019000787287950516, "index": 1, "_type": "BlockChunk"}, {"content": " is", "logprob": -0.06291279196739197, "index": 1, "_type": "BlockChunk"}, {"content": " asking", "logprob": -0.10593139380216599, "index": 1, "_type": "BlockChunk"}, {"content": " about", "logprob": -0.8573232293128967, "index": 1, "_type": "BlockChunk"}, {"content": " my", "logprob": -0.028426658362150192, "index": 1, "_type": "BlockChunk"}, {"content": " identity", "logprob": -0.018328918144106865, "index": 1, "_type": "BlockChunk"}, {"content": " and", "logprob": -0.6680499315261841, "index": 1, "_type": "BlockChunk"}, {"content": " role", "logprob": -0.14453263580799103, "index": 1, "_type": "BlockChunk"}, {"content": ",", "logprob": -2.4636576175689697, "index": 1, "_type": "BlockChunk"}, {"content": " so", "logprob": -0.8929778933525085, "index": 1, "_type": "BlockChunk"}, {"content": " I", "logprob": -0.022074365988373756, "index": 1, "_type": "BlockChunk"}, {"content": " need", "logprob": -0.4446248412132263, "index": 1, "_type": "BlockChunk"}, {"content": " to", "logprob": -3.173704271830502e-06, "index": 1, "_type": "BlockChunk"}, {"content": " clarify", "logprob": -0.960564911365509, "index": 1, "_type": "BlockChunk"}, {"content": " who", "logprob": -1.6055090427398682, "index": 1, "_type": "BlockChunk"}, {"content": " I", "logprob": -0.00025156480842269957, "index": 1, "_type": "BlockChunk"}, {"content": " am", "logprob": -0.0013333364622667432, "index": 1, "_type": "BlockChunk"}, {"content": " and", "logprob": -0.037862446159124374, "index": 1, "_type": "BlockChunk"}, {"content": " how", "logprob": -2.3482751846313477, "index": 1, "_type": "BlockChunk"}, {"content": " I", "logprob": -0.0003076950670219958, "index": 1, "_type": "BlockChunk"}, {"content": " can", "logprob": -0.005449801217764616, "index": 1, "_type": "BlockChunk"}, {"content": " assist", "logprob": -0.017539504915475845, "index": 1, "_type": "BlockChunk"}, {"content": " them", "logprob": -0.030168581753969193, "index": 1, "_type": "BlockChunk"}, {"content": ".", "logprob": -0.06032119691371918, "index": 1, "_type": "BlockChunk"}]}, {"sep_list": [""], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": " ", "logprob": -4.0484450437361374e-05, "index": 2, "_type": "BlockChunk"}]}], "tags": ["thought", "tag_start"], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "role": null, "id": null}, {"root": {"sep_list": ["", "", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": " ", "logprob": -2.236549335066229e-05, "index": 3, "_type": "BlockChunk"}, {"content": " <", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": "answer", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": ">", "logprob": -1.1041145626222715e-05, "index": 1, "_type": "BlockChunk"}]}, "children": [{"sep_list": ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": "   ", "logprob": -0.00297354138456285, "index": 1, "_type": "BlockChunk"}, {"content": " I", "logprob": -0.40466755628585815, "index": 1, "_type": "BlockChunk"}, {"content": " am", "logprob": -0.0004309076175559312, "index": 1, "_type": "BlockChunk"}, {"content": " a", "logprob": -0.008651918731629848, "index": 1, "_type": "BlockChunk"}, {"content": " customer", "logprob": -0.5145837068557739, "index": 1, "_type": "BlockChunk"}, {"content": " support", "logprob": -3.531315314830863e-06, "index": 1, "_type": "BlockChunk"}, {"content": " assistant", "logprob": -6.749814019713085e-06, "index": 1, "_type": "BlockChunk"}, {"content": " for", "logprob": -0.0038478169590234756, "index": 1, "_type": "BlockChunk"}, {"content": " Shipping", "logprob": -0.5512996315956116, "index": 1, "_type": "BlockChunk"}, {"content": "To", "logprob": -0.00025204161647707224, "index": 1, "_type": "BlockChunk"}, {"content": "Go", "logprob": -1.664371848164592e-05, "index": 1, "_type": "BlockChunk"}, {"content": ".", "logprob": -0.9744064211845398, "index": 1, "_type": "BlockChunk"}, {"content": " I'm", "logprob": -0.1787855327129364, "index": 1, "_type": "BlockChunk"}, {"content": " here", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": " to", "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": " help", "logprob": -0.06998012214899063, "index": 1, "_type": "BlockChunk"}, {"content": " you", "logprob": -0.007894543930888176, "index": 1, "_type": "BlockChunk"}, {"content": " with", "logprob": -1.0280383548888494e-06, "index": 1, "_type": "BlockChunk"}, {"content": " any", "logprob": -0.2818658947944641, "index": 1, "_type": "BlockChunk"}, {"content": " shipping", "logprob": -0.2560439705848694, "index": 1, "_type": "BlockChunk"}, {"content": " needs", "logprob": -0.14240358769893646, "index": 1, "_type": "BlockChunk"}, {"content": " or", "logprob": -0.5246978402137756, "index": 1, "_type": "BlockChunk"}, {"content": " inquiries", "logprob": -0.1975722312927246, "index": 1, "_type": "BlockChunk"}, {"content": " you", "logprob": -0.0007337473216466606, "index": 1, "_type": "BlockChunk"}, {"content": " might", "logprob": -1.2579807043075562, "index": 1, "_type": "BlockChunk"}, {"content": " have", "logprob": -3.128163257315464e-07, "index": 1, "_type": "BlockChunk"}, {"content": ".", "logprob": -0.0798281878232956, "index": 1, "_type": "BlockChunk"}, {"content": " How", "logprob": -0.07879845798015594, "index": 1, "_type": "BlockChunk"}, {"content": " can", "logprob": -0.05488329753279686, "index": 1, "_type": "BlockChunk"}, {"content": " I", "logprob": -1.9361264946837764e-07, "index": 1, "_type": "BlockChunk"}, {"content": " assist", "logprob": -0.00016551809676457196, "index": 1, "_type": "BlockChunk"}, {"content": " you", "logprob": -3.128163257315464e-07, "index": 1, "_type": "BlockChunk"}, {"content": " today", "logprob": -0.00023405285901390016, "index": 1, "_type": "BlockChunk"}, {"content": "?", "logprob": -0.0015530710807070136, "index": 1, "_type": "BlockChunk"}]}, {"sep_list": [""], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": " ", "logprob": -7.703443770878948e-06, "index": 2, "_type": "BlockChunk"}]}], "tags": ["answer", "tag_start"], "styles": [], "attrs": {}, "index": 2, "_type": "Block", "role": null, "id": null}, {"sep_list": ["", ""], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": " ", "logprob": -0.10591595619916916, "index": 3, "_type": "BlockChunk"}, {"content": " ", "logprob": -2.236549335066229e-05, "index": 3, "_type": "BlockChunk"}]}], "tags": ["output", "tag_start"], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "role": null, "id": null}], "tags": [], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "role": null, "id": null}, "index": 75, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "4e593520-1806-4ff1-8203-e03d5a62a45b", "path": [3], "created_at": "2025-08-25T08:44:34.972941"},
//   {"type": "span_end", "name": "shiping_reasoning", "attrs": null, "depth": 0, "payload": null, "index": 76, "request_id": "332da3b7-5652-4f82-a97a-8a984d772749", "span_id": "4e593520-1806-4ff1-8203-e03d5a62a45b", "path": [3], "created_at": "2025-08-25T08:44:34.991958"}  ,
// ]
// const mockEvents = [
//   {"type": "span_start", "name": "test_city_prompt", "attrs": null, "depth": 0, "payload": null, "index": 0, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "25853a24-93e9-4471-98b4-4d88710cd2cc", "path": [0], "created_at": "2025-08-26T10:47:21.841005"},
//   {"type": "span_value", "name": "test_city_prompt", "attrs": null, "depth": 0, "payload": {"root": {"sep_list": [], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [], "path": [1]}, "children": [{"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "answer as short as possible", "index": 0, "_type": "BlockChunk"}], "path": [1, 1]}, {"sep_list": [" "], "has_eol": false, "index": 2, "_type": "BlockSent", "blocks": [{"content": "no unneccesary words", "index": 0, "_type": "BlockChunk"}], "path": [1, 2]}, {"root": {"sep_list": [], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [], "path": [1, 3]}, "children": [{"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "you must use the following format", "index": 0, "_type": "BlockChunk"}], "path": [1, 3, 1]}, {"type": "{'__new__': <built-in method __new__ of type object at 0x100b1a9d8>, '__repr__': <slot wrapper '__repr__' of 'str' objects>, '__hash__': <slot wrapper '__hash__' of 'str' objects>, '__str__': <slot wrapper '__str__' of 'str' objects>, '__getattribute__': <slot wrapper '__getattribute__' of 'str' objects>, '__lt__': <slot wrapper '__lt__' of 'str' objects>, '__le__': <slot wrapper '__le__' of 'str' objects>, '__eq__': <slot wrapper '__eq__' of 'str' objects>, '__ne__': <slot wrapper '__ne__' of 'str' objects>, '__gt__': <slot wrapper '__gt__' of 'str' objects>, '__ge__': <slot wrapper '__ge__' of 'str' objects>, '__iter__': <slot wrapper '__iter__' of 'str' objects>, '__mod__': <slot wrapper '__mod__' of 'str' objects>, '__rmod__': <slot wrapper '__rmod__' of 'str' objects>, '__len__': <slot wrapper '__len__' of 'str' objects>, '__getitem__': <slot wrapper '__getitem__' of 'str' objects>, '__add__': <slot wrapper '__add__' of 'str' objects>, '__mul__': <slot wrapper '__mul__' of 'str' objects>, '__rmul__': <slot wrapper '__rmul__' of 'str' objects>, '__contains__': <slot wrapper '__contains__' of 'str' objects>, 'encode': <method 'encode' of 'str' objects>, 'replace': <method 'replace' of 'str' objects>, 'split': <method 'split' of 'str' objects>, 'rsplit': <method 'rsplit' of 'str' objects>, 'join': <method 'join' of 'str' objects>, 'capitalize': <method 'capitalize' of 'str' objects>, 'casefold': <method 'casefold' of 'str' objects>, 'title': <method 'title' of 'str' objects>, 'center': <method 'center' of 'str' objects>, 'count': <method 'count' of 'str' objects>, 'expandtabs': <method 'expandtabs' of 'str' objects>, 'find': <method 'find' of 'str' objects>, 'partition': <method 'partition' of 'str' objects>, 'index': <method 'index' of 'str' objects>, 'ljust': <method 'ljust' of 'str' objects>, 'lower': <method 'lower' of 'str' objects>, 'lstrip': <method 'lstrip' of 'str' objects>, 'rfind': <method 'rfind' of 'str' objects>, 'rindex': <method 'rindex' of 'str' objects>, 'rjust': <method 'rjust' of 'str' objects>, 'rstrip': <method 'rstrip' of 'str' objects>, 'rpartition': <method 'rpartition' of 'str' objects>, 'splitlines': <method 'splitlines' of 'str' objects>, 'strip': <method 'strip' of 'str' objects>, 'swapcase': <method 'swapcase' of 'str' objects>, 'translate': <method 'translate' of 'str' objects>, 'upper': <method 'upper' of 'str' objects>, 'startswith': <method 'startswith' of 'str' objects>, 'endswith': <method 'endswith' of 'str' objects>, 'removeprefix': <method 'removeprefix' of 'str' objects>, 'removesuffix': <method 'removesuffix' of 'str' objects>, 'isascii': <method 'isascii' of 'str' objects>, 'islower': <method 'islower' of 'str' objects>, 'isupper': <method 'isupper' of 'str' objects>, 'istitle': <method 'istitle' of 'str' objects>, 'isspace': <method 'isspace' of 'str' objects>, 'isdecimal': <method 'isdecimal' of 'str' objects>, 'isdigit': <method 'isdigit' of 'str' objects>, 'isnumeric': <method 'isnumeric' of 'str' objects>, 'isalpha': <method 'isalpha' of 'str' objects>, 'isalnum': <method 'isalnum' of 'str' objects>, 'isidentifier': <method 'isidentifier' of 'str' objects>, 'isprintable': <method 'isprintable' of 'str' objects>, 'zfill': <method 'zfill' of 'str' objects>, 'format': <method 'format' of 'str' objects>, 'format_map': <method 'format_map' of 'str' objects>, '__format__': <method '__format__' of 'str' objects>, 'maketrans': <staticmethod(<built-in method maketrans of type object at 0x100b1a9d8>)>, '__sizeof__': <method '__sizeof__' of 'str' objects>, '__getnewargs__': <method '__getnewargs__' of 'str' objects>, '__doc__': \"str(object='') -> str\\nstr(bytes_or_buffer[, encoding[, errors]]) -> str\\n\\nCreate a new string object from the given object. If encoding or\\nerrors is specified, then the object must expose a data buffer\\nthat will be decoded using the given encoding and error handler.\\nOtherwise, returns the result of object.__str__() (if defined)\\nor repr(object).\\nencoding defaults to sys.getdefaultencoding().\\nerrors defaults to 'strict'.\"}", "name": "output", "root": {"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "output", "index": 0, "_type": "BlockChunk"}], "path": [1, 3, 2]}, "children": [{"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "your answer goes here", "index": 0, "_type": "BlockChunk"}], "path": [1, 3, 2, 1]}], "tags": [], "styles": ["xml"], "attrs": {}, "index": 2, "_type": "Block", "role": null, "id": null, "path": [1, 3, 2]}], "tags": ["response_schema"], "styles": [], "attrs": {}, "index": 3, "_type": "Block", "role": null, "id": null, "path": [1, 3]}], "role": "system", "tags": [], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "id": null, "path": [1]}, "index": 1, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "25853a24-93e9-4471-98b4-4d88710cd2cc", "path": [1], "created_at": "2025-08-26T10:47:21.865622"},
//   {"type": "stream_start", "name": "openai_llm", "attrs": null, "depth": 0, "payload": null, "index": 2, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "c813468b-479a-4b08-a4ff-024d17e53f13", "path": [1, 0], "created_at": "2025-08-26T10:47:21.913333"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"root": {"sep_list": ["", "", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": "", "children": [], "logprob": 0, "index": 0, "_type": "BlockChunk"}, {"content": "<", "children": [], "logprob": -0.00021438424300868064, "index": 1, "_type": "BlockChunk"}, {"content": "output", "children": [], "logprob": -6.704273118884885e-07, "index": 2, "_type": "BlockChunk"}, {"content": ">", "children": [], "logprob": -0.0002644351334311068, "index": 3, "_type": "BlockChunk"}], "path": [1]}, "children": [], "tags": ["output", "tag_start"], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "role": null, "id": null, "path": [1], "postfix": null}, "index": 3, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "c813468b-479a-4b08-a4ff-024d17e53f13", "path": [1, 0], "created_at": "2025-08-26T10:47:22.201406"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"sep_list": [""], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "Paris", "children": [], "logprob": -0.016601165756583214, "index": 0, "_type": "BlockChunk"}], "path": [1, 1]}, "index": 4, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "c813468b-479a-4b08-a4ff-024d17e53f13", "path": [1, 0], "created_at": "2025-08-26T10:47:22.275536"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": ",", "children": [], "logprob": -0.06512050330638885, "index": 1, "_type": "BlockChunk"}, "index": 5, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "c813468b-479a-4b08-a4ff-024d17e53f13", "path": [1, 0], "created_at": "2025-08-26T10:47:22.347677"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " Rome", "children": [], "logprob": -1.9361264946837764e-07, "index": 2, "_type": "BlockChunk"}, "index": 6, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "c813468b-479a-4b08-a4ff-024d17e53f13", "path": [1, 0], "created_at": "2025-08-26T10:47:22.421531"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": ",", "children": [], "logprob": -5.490809417096898e-05, "index": 3, "_type": "BlockChunk"}, "index": 7, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "c813468b-479a-4b08-a4ff-024d17e53f13", "path": [1, 0], "created_at": "2025-08-26T10:47:22.494079"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": " Berlin", "children": [], "logprob": -0.011048170737922192, "index": 4, "_type": "BlockChunk"}, "index": 8, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "c813468b-479a-4b08-a4ff-024d17e53f13", "path": [1, 0], "created_at": "2025-08-26T10:47:22.567568"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"content": "", "children": [], "logprob": -0.05646219849586487, "index": 5, "_type": "BlockChunk"}, "index": 9, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "c813468b-479a-4b08-a4ff-024d17e53f13", "path": [1, 0], "created_at": "2025-08-26T10:47:22.640810"},
//   {"type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": {"sep_list": ["", "", ""], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "</", "children": [], "logprob": -5.512236498361744e-07, "index": 0, "_type": "BlockChunk"}, {"content": "output", "children": [], "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": ">", "children": [], "logprob": -0.00034177995985373855, "index": 2, "_type": "BlockChunk"}], "path": [1]}, "index": 10, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "c813468b-479a-4b08-a4ff-024d17e53f13", "path": [1, 0], "created_at": "2025-08-26T10:47:22.856921"},
//   {"type": "stream_end", "name": "openai_llm", "attrs": null, "depth": 0, "payload": null, "index": 11, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "c813468b-479a-4b08-a4ff-024d17e53f13", "path": [1, 0], "created_at": "2025-08-26T10:47:22.868009"},
//   {"type": "span_value", "name": "test_city_prompt", "attrs": null, "depth": 0, "payload": {"_value": "Paris, Rome, Berlin", "postfix": {"sep_list": ["", "", ""], "has_eol": false, "index": 1, "_type": "BlockSent", "blocks": [{"content": "</", "children": [], "logprob": -5.512236498361744e-07, "index": 0, "_type": "BlockChunk"}, {"content": "output", "children": [], "logprob": 0.0, "index": 1, "_type": "BlockChunk"}, {"content": ">", "children": [], "logprob": -0.00034177995985373855, "index": 2, "_type": "BlockChunk"}], "path": [1]}, "root": {"sep_list": ["", "", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": "", "children": [], "logprob": 0, "index": 0, "_type": "BlockChunk"}, {"content": "<", "children": [], "logprob": -0.00021438424300868064, "index": 1, "_type": "BlockChunk"}, {"content": "output", "children": [], "logprob": -6.704273118884885e-07, "index": 2, "_type": "BlockChunk"}, {"content": ">", "children": [], "logprob": -0.0002644351334311068, "index": 3, "_type": "BlockChunk"}], "path": [1]}, "children": [{"sep_list": ["", "", "", "", "", ""], "has_eol": true, "index": 1, "_type": "BlockSent", "blocks": [{"content": "Paris", "children": [], "logprob": -0.016601165756583214, "index": 0, "_type": "BlockChunk"}, {"content": ",", "children": [], "logprob": -0.06512050330638885, "index": 1, "_type": "BlockChunk"}, {"content": " Rome", "children": [], "logprob": -1.9361264946837764e-07, "index": 2, "_type": "BlockChunk"}, {"content": ",", "children": [], "logprob": -5.490809417096898e-05, "index": 3, "_type": "BlockChunk"}, {"content": " Berlin", "children": [], "logprob": -0.011048170737922192, "index": 4, "_type": "BlockChunk"}, {"content": "", "children": [], "logprob": -0.05646219849586487, "index": 5, "_type": "BlockChunk"}], "path": [1, 1]}], "tags": ["output", "tag_start"], "styles": [], "attrs": {}, "index": 1, "_type": "Block", "role": null, "id": null, "path": [1]}, "index": 12, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "25853a24-93e9-4471-98b4-4d88710cd2cc", "path": [2], "created_at": "2025-08-26T10:47:22.928634"},
//   {"type": "span_end", "name": "test_city_prompt", "attrs": null, "depth": 0, "payload": null, "index": 13, "request_id": "5d36ca38-094a-4f53-9b29-f5220876953c", "span_id": "25853a24-93e9-4471-98b4-4d88710cd2cc", "path": [2], "created_at": "2025-08-26T10:47:22.940837"},
// ]
const mockEvents = [
    { "type": "span_start", "name": "test_city_prompt", "attrs": null, "depth": 0, "payload": { "branch_id": 1, "turn_id": 15, "turn": "Turn", "branch": "Branch", "id": "72265441-842d-4c3e-817e-be833e3a921d", "name": "test_city_prompt", "span_type": "component", "parent_span_id": null, "start_time": "2025-08-26T18:21:40.275748", "end_time": null, "depth": 0, "metadata": {}, "status": "running", "index": 0, "events": [], "block_trees": [] }, "index": 0, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "72265441-842d-4c3e-817e-be833e3a921d", "path": [0], "event": null, "created_at": "2025-08-26T18:21:40.292682" },
    // {"type": "span_value", "name": "test_city_prompt", "attrs": null, "depth": 0, "payload": {"root": {"sep_list": [], "has_eol": false, "index": 0, "_type": "BlockSent", "children": [], "path": [0]}, "children": [{"sep_list": [" "], "has_eol": false, "index": 0, "_type": "BlockSent", "children": [{"content": "answer as short as possible", "index": 0, "_type": "BlockChunk", "path": [0, 0, 0]}], "path": [0, 0]}, {"sep_list": [" "], "has_eol": false, "index": 1, "_type": "BlockSent", "children": [{"content": "no unneccesary words", "index": 0, "_type": "BlockChunk", "path": [0, 1, 0]}], "path": [0, 1]}, {"root": {"sep_list": [], "has_eol": false, "index": 0, "_type": "BlockSent", "children": [], "path": [0, 2]}, "children": [{"sep_list": [" "], "has_eol": false, "index": 0, "_type": "BlockSent", "children": [{"content": "you must use the following format", "index": 0, "_type": "BlockChunk", "path": [0, 2, 0, 0]}], "path": [0, 2, 0]}, {"type": "str", "name": "output", "root": {"sep_list": [" "], "has_eol": false, "index": 0, "_type": "BlockSent", "children": [{"content": "output", "index": 0, "_type": "BlockChunk", "path": [0, 2, 1, 0]}], "path": [0, 2, 1]}, "children": [{"sep_list": [" "], "has_eol": false, "index": 0, "_type": "BlockSent", "children": [{"content": "your answer goes here", "index": 0, "_type": "BlockChunk", "path": [0, 2, 1, 0, 0]}], "path": [0, 2, 1, 0]}], "tags": [], "styles": ["xml"], "attrs": {}, "index": 1, "_type": "Block", "role": null, "id": null, "path": [0, 2, 1]}], "tags": ["response_schema"], "styles": [], "attrs": {}, "index": 2, "_type": "Block", "role": null, "id": null, "path": [0, 2]}], "role": "system", "tags": [], "styles": [], "attrs": {}, "index": 0, "_type": "Block", "id": null, "path": [0]}, "index": 1, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "72265441-842d-4c3e-817e-be833e3a921d", "path": [1], "event": {"id": 53, "created_at": "2025-08-26T18:21:40.329052", "event_type": "block", "table": null, "index": 1, "span_id": "72265441-842d-4c3e-817e-be833e3a921d", "event_id": "d20442d5-e7bc-4248-8299-43c8e9fb74f8"}, "created_at": "2025-08-26T18:21:40.342355"},
    { "type": "span_value", "name": "test_city_prompt", "attrs": null, "depth": 0, "payload": { "branch_id": 1, "turn_id": 15, "turn": "Turn", "branch": "Branch", "id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "name": "openai_llm", "span_type": "llm", "parent_span_id": "72265441-842d-4c3e-817e-be833e3a921d", "start_time": "2025-08-26T18:21:40.439209", "end_time": null, "depth": 0, "metadata": {}, "status": "running", "index": 0, "events": [], "block_trees": [] }, "index": 2, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "72265441-842d-4c3e-817e-be833e3a921d", "path": [2], "event": { "id": 54, "created_at": "2025-08-26T18:21:40.454606", "event_type": "span", "table": null, "index": 2, "span_id": "72265441-842d-4c3e-817e-be833e3a921d", "event_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a" }, "created_at": "2025-08-26T18:21:40.459075" },
    { "type": "stream_start", "name": "openai_llm", "attrs": null, "depth": 0, "payload": null, "index": 3, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "path": [0], "event": { "id": 55, "created_at": "2025-08-26T18:21:40.459649", "event_type": "stream", "table": null, "index": 0, "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "event_id": "" }, "created_at": "2025-08-26T18:21:40.464263" },
    { "type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": { "root": { "sep_list": ["", "", "", ""], "has_eol": true, "index": 0, "_type": "BlockSent", "children": [{ "content": "", "children": [], "logprob": 0, "index": 0, "_type": "BlockChunk", "path": [0, 0] }, { "content": "<", "children": [], "logprob": -0.00021438424300868064, "index": 1, "_type": "BlockChunk", "path": [0, 1] }, { "content": "output", "children": [], "logprob": -6.704273118884885e-07, "index": 2, "_type": "BlockChunk", "path": [0, 2] }, { "content": ">", "children": [], "logprob": -0.0002644351334311068, "index": 3, "_type": "BlockChunk", "path": [0, 3] }], "path": [0] }, "children": [], "tags": ["output", "tag_start"], "styles": [], "attrs": {}, "index": 0, "_type": "Block", "role": null, "id": null, "path": [0], "postfix": null }, "index": 4, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "path": [0], "event": { "id": 55, "created_at": "2025-08-26T18:21:40.459649", "event_type": "stream", "table": null, "index": 0, "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "event_id": "" }, "created_at": "2025-08-26T18:21:40.754682" },
    { "type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": { "sep_list": [""], "has_eol": false, "index": 0, "_type": "BlockSent", "children": [{ "content": "Paris", "children": [], "logprob": -0.016601165756583214, "index": 0, "_type": "BlockChunk", "path": [0, 0, 0] }], "path": [0, 0] }, "index": 5, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "path": [0], "event": { "id": 55, "created_at": "2025-08-26T18:21:40.459649", "event_type": "stream", "table": null, "index": 0, "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "event_id": "" }, "created_at": "2025-08-26T18:21:40.828431" },
    { "type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": { "content": ",", "children": [], "logprob": -0.06512050330638885, "index": 1, "_type": "BlockChunk", "path": [0, 0, 1] }, "index": 6, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "path": [0], "event": { "id": 55, "created_at": "2025-08-26T18:21:40.459649", "event_type": "stream", "table": null, "index": 0, "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "event_id": "" }, "created_at": "2025-08-26T18:21:40.934117" },
    { "type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": { "content": " Rome", "children": [], "logprob": -1.9361264946837764e-07, "index": 2, "_type": "BlockChunk", "path": [0, 0, 2] }, "index": 7, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "path": [0], "event": { "id": 55, "created_at": "2025-08-26T18:21:40.459649", "event_type": "stream", "table": null, "index": 0, "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "event_id": "" }, "created_at": "2025-08-26T18:21:41.037659" },
    { "type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": { "content": ",", "children": [], "logprob": -5.490809417096898e-05, "index": 3, "_type": "BlockChunk", "path": [0, 0, 3] }, "index": 8, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "path": [0], "event": { "id": 55, "created_at": "2025-08-26T18:21:40.459649", "event_type": "stream", "table": null, "index": 0, "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "event_id": "" }, "created_at": "2025-08-26T18:21:41.111820" },
    { "type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": { "content": " Berlin", "children": [], "logprob": -0.011048170737922192, "index": 4, "_type": "BlockChunk", "path": [0, 0, 4] }, "index": 9, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "path": [0], "event": { "id": 55, "created_at": "2025-08-26T18:21:40.459649", "event_type": "stream", "table": null, "index": 0, "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "event_id": "" }, "created_at": "2025-08-26T18:21:41.184745" },
    { "type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": { "content": "", "children": [], "logprob": -0.05646219849586487, "index": 5, "_type": "BlockChunk", "path": [0, 0, 5] }, "index": 10, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "path": [0], "event": { "id": 55, "created_at": "2025-08-26T18:21:40.459649", "event_type": "stream", "table": null, "index": 0, "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "event_id": "" }, "created_at": "2025-08-26T18:21:41.257643" },
    { "type": "stream_delta", "name": "openai_llm", "attrs": null, "depth": 0, "payload": { "sep_list": ["", "", ""], "has_eol": false, "index": 0, "_type": "BlockSent", "children": [{ "content": "</", "children": [], "logprob": -5.512236498361744e-07, "index": 0, "_type": "BlockChunk", "path": [0, 0] }, { "content": "output", "children": [], "logprob": 0.0, "index": 1, "_type": "BlockChunk", "path": [0, 1] }, { "content": ">", "children": [], "logprob": -0.00034177995985373855, "index": 2, "_type": "BlockChunk", "path": [0, 2] }], "path": [0, -1] }, "index": 11, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "path": [0, 1], "event": { "id": 55, "created_at": "2025-08-26T18:21:40.459649", "event_type": "stream", "table": null, "index": 0, "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "event_id": "" }, "created_at": "2025-08-26T18:21:41.477381" },
    { "type": "stream_end", "name": "openai_llm", "attrs": null, "depth": 0, "payload": null, "index": 12, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "path": [0], "event": { "id": 55, "created_at": "2025-08-26T18:21:40.459649", "event_type": "stream", "table": null, "index": 0, "span_id": "f3f5aa4b-0a83-473f-8db0-0c3a192fd37a", "event_id": "" }, "created_at": "2025-08-26T18:21:41.513652" },
    { "type": "span_value", "name": "test_city_prompt", "attrs": null, "depth": 0, "payload": { "_value": "Paris, Rome, Berlin", "postfix": { "sep_list": ["", "", ""], "has_eol": false, "index": 0, "_type": "BlockSent", "children": [{ "content": "</", "children": [], "logprob": -5.512236498361744e-07, "index": 0, "_type": "BlockChunk", "path": [0, 0] }, { "content": "output", "children": [], "logprob": 0.0, "index": 1, "_type": "BlockChunk", "path": [0, 1] }, { "content": ">", "children": [], "logprob": -0.00034177995985373855, "index": 2, "_type": "BlockChunk", "path": [0, 2] }], "path": [0] }, "root": { "sep_list": ["", "", "", ""], "has_eol": true, "index": 0, "_type": "BlockSent", "children": [{ "content": "", "children": [], "logprob": 0, "index": 0, "_type": "BlockChunk", "path": [0, 0] }, { "content": "<", "children": [], "logprob": -0.00021438424300868064, "index": 1, "_type": "BlockChunk", "path": [0, 1] }, { "content": "output", "children": [], "logprob": -6.704273118884885e-07, "index": 2, "_type": "BlockChunk", "path": [0, 2] }, { "content": ">", "children": [], "logprob": -0.0002644351334311068, "index": 3, "_type": "BlockChunk", "path": [0, 3] }], "path": [0] }, "children": [{ "sep_list": ["", "", "", "", "", ""], "has_eol": true, "index": 0, "_type": "BlockSent", "children": [{ "content": "Paris", "children": [], "logprob": -0.016601165756583214, "index": 0, "_type": "BlockChunk", "path": [0, 0, 0] }, { "content": ",", "children": [], "logprob": -0.06512050330638885, "index": 1, "_type": "BlockChunk", "path": [0, 0, 1] }, { "content": " Rome", "children": [], "logprob": -1.9361264946837764e-07, "index": 2, "_type": "BlockChunk", "path": [0, 0, 2] }, { "content": ",", "children": [], "logprob": -5.490809417096898e-05, "index": 3, "_type": "BlockChunk", "path": [0, 0, 3] }, { "content": " Berlin", "children": [], "logprob": -0.011048170737922192, "index": 4, "_type": "BlockChunk", "path": [0, 0, 4] }, { "content": "", "children": [], "logprob": -0.05646219849586487, "index": 5, "_type": "BlockChunk", "path": [0, 0, 5] }], "path": [0, 0] }], "tags": ["output", "tag_start"], "styles": [], "attrs": {}, "index": 0, "_type": "Block", "role": null, "id": null, "path": [0] }, "index": 13, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "72265441-842d-4c3e-817e-be833e3a921d", "path": [3], "event": { "id": 56, "created_at": "2025-08-26T18:21:41.541981", "event_type": "block", "table": null, "index": 3, "span_id": "72265441-842d-4c3e-817e-be833e3a921d", "event_id": "5c0fb4aa-3092-4576-b97f-930dd71b399d" }, "created_at": "2025-08-26T18:21:41.555496" },
    { "type": "span_end", "name": "test_city_prompt", "attrs": null, "depth": 0, "payload": null, "index": 14, "request_id": "2a64b9ef-1aaa-4689-ac70-6d5060d9621c", "span_id": "72265441-842d-4c3e-817e-be833e3a921d", "path": [3], "event": null, "created_at": "2025-08-26T18:21:41.572467" },
];
// export function useFakeStreamStore(delay = 50) {
//   const [events, setEvents] = useState<any[]>([]);
//   const [requestId, setRequestId] = useState<string | null>(null);
//   const [isStreaming, setIsStreaming] = useState(false);
//   const timerRef = useRef<NodeJS.Timeout | null>(null);
//   const indexRef = useRef(0);
//   const lastConsumedRef = useRef(-1);
//   const clearTimer = () => {
//     if (timerRef.current) clearTimeout(timerRef.current);
//     timerRef.current = null;
//   };
//   const clearStream = useCallback(() => {
//     clearTimer();
//     setEvents([]);
//     indexRef.current = 0;
//     lastConsumedRef.current = -1;
//     setIsStreaming(false);
//   }, []);
//   const startStream = useCallback(() => {
//     clearStream();
//     setRequestId(crypto.randomUUID());
//     setIsStreaming(true);
//     function tick() {
//       if (indexRef.current < mockEvents.length) {
//         setEvents((prev) => [...prev, mockEvents[indexRef.current]]);
//         indexRef.current++;
//         timerRef.current = setTimeout(tick, delay);
//       } else {
//         setIsStreaming(false);
//       }
//     }
//     tick();
//   }, [clearStream, delay]);
//   const resetStream = useCallback(() => {
//     clearStream();
//     startStream();
//   }, [clearStream, startStream]);
//   // ✅ consumed function inside the store
//   const consumed = useCallback((newEvents: any[]) => {
//     if (newEvents.length === 0) return;
//     const lastIndex = newEvents[newEvents.length - 1]?.index;
//     lastConsumedRef.current = lastIndex;
//   }, []);
//   return {
//     events,
//     requestId,
//     isStreaming,
//     startStream,
//     clearStream,
//     resetStream,
//     consumed,           // expose consumed
//     lastConsumedRef,    // optionally expose marker
//   };
// }
export function useFakeStreamStore(delay = 50) {
    const [allEvents, setAllEvents] = useState([]); // internal raw buffer
    const [events, setEvents] = useState([]); // exposed filtered events
    const [requestId, setRequestId] = useState(null);
    const [isStreaming, setIsStreaming] = useState(false);
    const timerRef = useRef(null);
    const indexRef = useRef(0);
    const lastConsumedRef = useRef(-1);
    const clearTimer = () => {
        if (timerRef.current)
            clearTimeout(timerRef.current);
        timerRef.current = null;
    };
    const clearStream = useCallback(() => {
        clearTimer();
        setAllEvents([]);
        setEvents([]);
        indexRef.current = 0;
        lastConsumedRef.current = -1;
        setIsStreaming(false);
    }, []);
    const startStream = useCallback(() => {
        clearStream();
        setRequestId(crypto.randomUUID());
        setIsStreaming(true);
        function tick() {
            if (indexRef.current < mockEvents.length) {
                const raw = mockEvents[indexRef.current];
                const next = convertKeysToCamelCase(raw);
                setAllEvents((prev) => [...prev, next]);
                // only expose events newer than lastConsumedRef
                if (next.index > lastConsumedRef.current) {
                    setEvents((prev) => [...prev, next]);
                }
                indexRef.current++;
                timerRef.current = setTimeout(tick, delay);
            }
            else {
                setIsStreaming(false);
            }
        }
        tick();
    }, [clearStream, delay]);
    const resetStream = useCallback(() => {
        startStream();
    }, [startStream]);
    // mark events consumed and clear the public buffer
    const consumed = useCallback((newEvents) => {
        if (newEvents.length === 0)
            return;
        const lastIndex = newEvents[newEvents.length - 1]?.index;
        lastConsumedRef.current = lastIndex;
        setEvents([]); // 🔑 clear out exposed list once consumed
    }, []);
    return {
        events, // ✅ always only fresh, unconsumed ones
        requestId,
        isStreaming,
        startStream,
        clearStream,
        resetStream,
        consumed,
        lastConsumedRef,
    };
}
//# sourceMappingURL=fakeEvents.js.map